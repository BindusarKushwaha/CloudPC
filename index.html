<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enterprise W365 TCO Model - Final v8</title>
    <style>
        :root {
            --primary: #0078d4;
            --bg: #f3f2f1;
            --card-bg: #ffffff;
            --text-main: #323130;
            --header-capex: #d13438;
            --header-opex: #0078d4;
            --header-indirect: #ff8c00;
            --header-savings: #107c10;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            padding: 20px;
            margin: 0;
        }

        .container { max-width: 1400px; margin: 0 auto; }

        /* HEADER */
        header { 
            background: #fff; padding: 25px; border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); margin-bottom: 20px;
        }
        h1 { margin: 0 0 5px 0; color: var(--primary); font-size: 1.8em; }

        /* CONTROLS */
        .controls-grid {
            display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 20px;
            align-items: end; margin-top: 15px;
        }
        select { 
            width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 4px; 
            font-size: 1em; background: #faf9f8; cursor: pointer;
        }

        /* GRID */
        .calc-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;
        }
        @media (max-width: 900px) { .calc-grid { grid-template-columns: 1fr; } }

        .column {
            background: var(--card-bg); border-radius: 8px; overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex; flex-direction: column;
        }
        .col-title { padding: 12px; background: #333; color: white; text-align: center; font-weight: bold; font-size: 1.1em; }

        .section-header {
            padding: 8px 20px; font-size: 0.75em; font-weight: 800; text-transform: uppercase;
            border-top: 1px solid #eee; border-bottom: 1px solid #eee; background: #faf9f8; letter-spacing: 0.5px;
        }
        .text-capex { color: var(--header-capex); }
        .text-opex { color: var(--header-opex); }
        .text-indirect { color: var(--header-indirect); }
        .text-savings { color: var(--header-savings); }

        .inputs-wrapper { padding: 15px 20px; }
        .form-group { margin-bottom: 12px; position: relative; }
        
        .label-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px; }
        .label-text { font-size: 0.85em; font-weight: 600; display: flex; align-items: center; gap: 6px; }
        
        /* TOOLTIP */
        .info-icon {
            cursor: help; color: #0078d4; font-size: 1.1em; position: relative; display: inline-block;
        }
        .info-icon::after {
            content: attr(data-tooltip);
            position: absolute; left: 50%; bottom: 120%; transform: translateX(-50%);
            width: 260px; background: #333; color: #fff; padding: 10px; border-radius: 6px;
            font-size: 0.8em; font-weight: normal; line-height: 1.4;
            visibility: hidden; opacity: 0; transition: opacity 0.2s; z-index: 100;
            pointer-events: none; text-align: left; box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .info-icon:hover::after { visibility: visible; opacity: 1; }

        /* INPUTS */
        .input-group { position: relative; }
        .currency-symbol {
            position: absolute; left: 10px; top: 50%; transform: translateY(-50%);
            color: #666; font-weight: bold; font-size: 0.9em; pointer-events: none;
        }
        input { 
            width: 100%; padding: 8px 10px 8px 25px;
            border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; 
            font-size: 0.95em; transition: 0.2s; 
        }
        .savings-input input { color: #107c10; font-weight: bold; }

        /* RESULTS */
        .tco-card {
            background: #252423; color: white; border-radius: 12px; padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        .tco-header { display: flex; justify-content: space-between; align-items: end; border-bottom: 1px solid #555; padding-bottom: 20px; margin-bottom: 30px; }
        .savings-badge { font-size: 1.2em; font-weight: bold; padding: 8px 20px; border-radius: 6px; border: 1px solid #555; background: rgba(255,255,255,0.05); }

        /* CHARTS */
        .chart-row { display: flex; align-items: center; margin-bottom: 15px; }
        .chart-label { width: 100px; font-weight: bold; font-size: 1em; }
        .chart-track { flex-grow: 1; background: #3b3a39; height: 35px; border-radius: 6px; overflow: hidden; }
        .chart-bar { height: 100%; display: flex; align-items: center; justify-content: flex-end; padding-right: 15px; font-weight: bold; font-size: 0.9em; white-space: nowrap; transition: width 0.6s cubic-bezier(0.2, 0.8, 0.2, 1); }
        .bar-laptop { background: #d83b01; }
        .bar-cloud { background: #0078d4; }

        /* BREAKDOWN */
        .breakdown-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin-top: 20px; }
        .bd-col { padding: 0 10px; }
        .bd-row { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 0.9em; opacity: 0.9; border-bottom: 1px solid #444; padding-bottom: 4px;}
        .bd-total { display: flex; justify-content: space-between; font-weight: bold; font-size: 1.2em; margin-top: 15px; padding-top: 10px; border-top: 2px solid #666; opacity: 1; }
        
        /* FOOTER */
        .designer-credit {
            text-align: center;
            margin-top: 30px;
            font-size: 0.75em;
            color: #888;
            letter-spacing: 0.5px;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Enterprise TCO Model v8</h1>
        <p style="margin:0; color:#666; font-size: 0.9em;">Lifecycle Extension Savings + Opportunity Cost of Capital (10%)</p>
        
        <div class="controls-grid">
            <div class="control-item">
                <label>Select Use Case Profile</label>
                <select id="profileSelect" onchange="loadProfile()">
                    <optgroup label="Workforce Types">
                        <option value="intl" selected>International Users (Default)</option>
                        <option value="scalable">Scalable Computing</option>
                        <option value="byod">BYOD</option>
                        <option value="remote">Remote Workforce</option>
                        <option value="temp">Contractors</option>
                    </optgroup>
                    <optgroup label="High Value">
                        <option value="dev">Developers</option>
                        <option value="exec">Executives</option>
                        <option value="gpu">GPU / Design</option>
                    </optgroup>
                </select>
            </div>
            <div class="control-item">
                <label>Currency</label>
                <select id="currency" onchange="changeCurrency()">
                    <option value="USD" selected>üá∫üá∏ USD ($)</option>
                    <option value="INR">üáÆüá≥ INR (‚Çπ)</option>
                </select>
            </div>
            <div class="control-item">
                <label>Analysis Duration (Years)</label>
                <select id="duration" onchange="handleDurationChange()">
                    <option value="12">1 Year</option>
                    <option value="24">2 Years</option>
                    <option value="36" selected>3 Years</option>
                    <option value="48">4 Years</option>
                    <option value="60">5 Years</option>
                </select>
            </div>
        </div>
    </header>

    <div class="calc-grid">
        
        <div class="column">
            <div class="col-title">üíª Physical Laptop</div>
            
            <div class="section-header text-capex">Hardware & CapEx</div>
            <div class="inputs-wrapper">
                <div class="form-group">
                    <div class="label-row"><span class="label-text">Hardware Cost <span class="info-icon" data-tooltip="Base purchase price of the laptop/desktop device.">‚ìò</span></span></div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="l_hw" oninput="calc()"></div>
                </div>
                <div class="form-group">
                    <div class="label-row"><span class="label-text">Extended Warranty <span class="info-icon" data-tooltip="Cost of extended warranty (e.g., AppleCare, Dell ProSupport) beyond standard 1 year.">‚ìò</span></span></div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="l_warranty" oninput="calc()"></div>
                </div>
                <div class="form-group">
                    <div class="label-row"><span class="label-text">Warranty / Refresh Cycle <span class="info-icon" data-tooltip="The mandatory replacement cycle for physical devices (e.g., every 3 years).">‚ìò</span></span></div>
                    <div class="input-group"><span class="currency-symbol" style="font-size:0.8em">Y</span><input type="number" id="l_lifespan" value="3" oninput="calc()"></div>
                </div>
                <div class="form-group">
                    <div class="label-row"><span class="label-text">Max Usable Life (Total) <span class="info-icon" data-tooltip="Total life of device if reused as a Thin Client. Difference between this and Warranty Cycle = Savings.">‚ìò</span></span></div>
                    <div class="input-group"><span class="currency-symbol" style="font-size:0.8em">Y</span><input type="number" id="l_max_life" value="5" oninput="calc()"></div>
                </div>
                <div class="form-group">
                    <div class="label-row"><span class="label-text">Logistics & Setup <span class="info-icon" data-tooltip="Shipping, asset tagging, imaging, and delivery costs per device.">‚ìò</span></span></div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="l_logistics" oninput="calc()"></div>
                </div>
            </div>

            <div class="section-header text-opex">IT Ops & Support</div>
            <div class="inputs-wrapper">
                <div class="form-group">
                    <div class="label-row"><span class="label-text">Monthly Support <span class="info-icon" data-tooltip="Cost of L1/L2 helpdesk tickets and physical break/fix support per month.">‚ìò</span></span></div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="l_support" oninput="calc()"></div>
                </div>
                </div>

            <div class="section-header text-indirect">Indirect / Productivity</div>
            <div class="inputs-wrapper">
                <div class="form-group">
                    <div class="label-row"><span class="label-text">Procurement Overhead <span class="info-icon" data-tooltip="Internal labor cost for PO processing, vendor negotiation, and inventory mgmt.">‚ìò</span></span></div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="l_proc" oninput="calc()"></div>
                </div>
                <div class="form-group">
                    <div class="label-row"><span class="label-text">Over-Provisioning Waste <span class="info-icon" data-tooltip="Cost of paying for fixed hardware specs that go unused (e.g. 32GB RAM for simple tasks).">‚ìò</span></span></div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="l_waste" oninput="calc()"></div>
                </div>
                <div class="form-group">
                    <div class="label-row"><span class="label-text">Productivity Loss (Annual) <span class="info-icon" data-tooltip="Annual cost of user downtime due to patching, reboots, and hardware failures.">‚ìò</span></span></div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="l_prod" oninput="calc()"></div>
                </div>
            </div>
        </div>

        <div class="column">
            <div class="col-title">‚òÅÔ∏è Windows 365</div>
            
            <div class="section-header text-capex">Setup & Access</div>
            <div class="inputs-wrapper">
                <div class="form-group">
                    <div class="label-row"><span class="label-text">Thin Client / BYOD Cost <span class="info-icon" data-tooltip="Cost of a low-end thin client or BYOD stipend.">‚ìò</span></span></div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="c_hw" oninput="calc()"></div>
                </div>
            </div>

            <div class="section-header text-opex">Cloud Subscription</div>
            <div class="inputs-wrapper">
                <div class="form-group">
                    <div class="label-row"><span class="label-text">Config SKU <span class="info-icon" data-tooltip="Prices inflate 10% annually in Years 2+">‚ìò</span></span></div>
                    <select id="w365_config" onchange="updateW365Price()">
                        <option value="basic">Basic: 2vCPU / 4GB</option>
                        <option value="standard">Standard: 2vCPU / 8GB</option>
                        <option value="premium">Premium: 4vCPU / 16GB</option>
                        <option value="power">Power: 8vCPU / 32GB</option>
                        <option value="gpu">Workstation: GPU</option>
                    </select>
                </div>
                <div class="form-group">
                    <div class="label-row"><span class="label-text">Monthly License Fee <span class="info-icon" data-tooltip="Flat per-user/month subscription cost for the Cloud PC.">‚ìò</span></span></div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="c_lic" oninput="calc()"></div>
                </div>
                <div class="form-group">
                    <div class="label-row"><span class="label-text">Mgmt Overhead (Mo) <span class="info-icon" data-tooltip="Intune/Endpoint Manager labor (typically lower than physical device mgmt).">‚ìò</span></span></div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="c_mgmt" oninput="calc()"></div>
                </div>
            </div>

            <div class="section-header text-savings">Strategic Value (Savings)</div>
            <div class="inputs-wrapper">
                <div class="form-group savings-input">
                    <div class="label-row"><span class="label-text">Extension Saving / Year <span class="info-icon" data-tooltip="Annual savings generated by not purchasing new hardware during the extension years.">‚ìò</span></span></div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="c_life_save_rate" value="200" oninput="calc()"></div>
                </div>
                <div class="form-group savings-input">
                    <div class="label-row"><span class="label-text">Better Security Value <span class="info-icon" data-tooltip="Monetary value of risk mitigation (no data on device). Appears as Negative Cost.">‚ìò</span></span></div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="c_sec_val" value="0" oninput="calc()"></div>
                </div>
                <div class="form-group savings-input">
                    <div class="label-row"><span class="label-text">BCP / Disaster Value <span class="info-icon" data-tooltip="Value of business continuity (instant recovery). Appears as Negative Cost.">‚ìò</span></span></div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="c_bcp_val" value="0" oninput="calc()"></div>
                </div>
                 <div class="form-group">
                    <div class="label-row"><span class="label-text" style="color:#333">Productivity Loss (Annual) <span class="info-icon" data-tooltip="Wait time for provisioning or connectivity (typically minimal).">‚ìò</span></span></div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="c_prod" oninput="calc()"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="tco-card">
        <div class="tco-header">
            <div>
                <h2 id="resultTitle">3-Year TCO Comparison</h2>
                <small style="opacity:0.7">Includes 10% Capital Cost on Upfront Hardware</small>
            </div>
            <div class="savings-badge" id="verdict_badge">Calculating...</div>
        </div>

        <div style="margin-bottom:30px;">
            <div class="chart-row">
                <div class="chart-label">üíª Laptop</div>
                <div class="chart-track">
                    <div class="chart-bar bar-laptop" id="bar_laptop" style="width: 50%;">$0</div>
                </div>
            </div>
            <div class="chart-row">
                <div class="chart-label">‚òÅÔ∏è W365</div>
                <div class="chart-track">
                    <div class="chart-bar bar-cloud" id="bar_cloud" style="width: 50%;">$0</div>
                </div>
            </div>
        </div>

        <div class="breakdown-grid">
            <div class="bd-col">
                <div class="bd-row" style="color:var(--header-capex)"><span>CapEx + 10% Cost of Capital</span> <span id="r_l_capex">$0</span></div>
                <div class="bd-row" style="color:var(--header-opex)"><span>OpEx (Recurring)</span> <span id="r_l_opex">$0</span></div>
                <div class="bd-row" style="color:var(--header-indirect)"><span>Indirect (Annual Prod)</span> <span id="r_l_indirect">$0</span></div>
                <div class="bd-total"><span>Laptop Total</span> <span id="r_l_total">$0</span></div>
            </div>
            <div class="bd-col">
                <div class="bd-row" style="color:var(--header-capex)"><span>CapEx (One-Time)</span> <span id="r_c_capex">$0</span></div>
                <div class="bd-row" style="color:var(--header-opex)"><span>OpEx (Recurring + 10%)</span> <span id="r_c_opex">$0</span></div>
                <div class="bd-row" style="color:var(--header-savings)"><span>Strategic Savings</span> <span id="r_c_savings">$0</span></div>
                <div class="bd-total"><span>W365 Total</span> <span id="r_c_total">$0</span></div>
            </div>
        </div>
    </div>
    
    <div class="designer-credit">designed by Bindusar and Avish</div>
</div>

<script>
    // --- 1. CONFIG DATA ---
    const w365_skus = {
        basic: { usd: 31, inr: 2785 },
        standard: { usd: 41, inr: 3685 },
        premium: { usd: 66, inr: 5930 },
        power: { usd: 158, inr: 11050 },
        gpu: { usd: 350, inr: 25000 }
    };

    // Helper: L[HW, War, Log, Sup, Proc, Wst, Prod] (SEC REMOVED) | C[HW, Mgmt, SaveRate, SecVal, BCPVal, Prod, SKU]
    function p(l, c, l_inr, c_inr) {
        return {
            usd: { 
                l: { hw: l[0], war: l[1], log: l[2], supp: l[3], proc: l[4], waste: l[5], prod: l[6] }, 
                c: { hw: c[0], mgmt: c[1], save_rate: c[2], sec: c[3], bcp: c[4], prod: c[5], sku: c[6] } 
            },
            inr: {
                l: { hw: l_inr[0], war: l_inr[1], log: l_inr[2], supp: l_inr[3], proc: l_inr[4], waste: l_inr[5], prod: l_inr[6] },
                c: { hw: c_inr[0], mgmt: c_inr[1], save_rate: c_inr[2], sec: c_inr[3], bcp: c_inr[4], prod: c_inr[5], sku: c[6] }
            }
        };
    }

    const profiles = {
        intl: p([1400, 150, 800, 60, 300, 200, 300], [0, 5, -200, -50, -100, 50, 'standard'], 
                [100000, 12000, 30000, 3500, 15000, 10000, 25000], [0, 400, -15000, -4000, -8000, 4000, 'standard']),
        
        scalable: p([1200, 100, 150, 30, 50, 100, 100], [0, 5, -200, -30, -50, 25, 'standard'], 
                    [85000, 8000, 5000, 1500, 3000, 5000, 8000], [0, 400, -15000, -2500, -4000, 2000, 'standard']),
        
        byod: p([1200, 100, 150, 30, 50, 100, 100], [0, 5, 0, -30, -50, 25, 'standard'], 
                [85000, 8000, 5000, 1500, 3000, 5000, 8000], [0, 400, 0, -2500, -4000, 2000, 'standard']),

        gpu: p([4000, 400, 200, 60, 200, 800, 500], [0, 5, -500, -100, -300, 50, 'gpu'], 
               [350000, 35000, 10000, 4000, 10000, 50000, 40000], [0, 400, -40000, -8000, -25000, 4000, 'gpu']),
    };
    // Default fallback
    profiles.dev = profiles.gpu;
    profiles.remote = profiles.intl;
    profiles.temp = profiles.scalable;
    profiles.exec = profiles.gpu;

    let currentCurrency = 'USD';

    function changeCurrency() {
        currentCurrency = document.getElementById('currency').value;
        const symbol = currentCurrency === 'USD' ? '$' : '‚Çπ';
        document.querySelectorAll('.currency-symbol').forEach(span => {
            if(span.innerText !== 'Y') span.innerText = symbol;
        });
        loadProfile();
    }

    function handleDurationChange() {
        const dur = document.getElementById('duration').value;
        const years = parseInt(dur) / 12;
        // Default the Warranty Cycle to match analysis period initially for convenience
        document.getElementById('l_lifespan').value = years;
        // Default Max Life to Warranty + 2
        document.getElementById('l_max_life').value = years + 2;
        calc();
    }

    function updateW365Price() {
        const sku = document.getElementById('w365_config').value;
        const price = w365_skus[sku][currentCurrency.toLowerCase()];
        document.getElementById('c_lic').value = price;
        calc();
    }

    function loadProfile() {
        const key = document.getElementById('profileSelect').value;
        const p = profiles[key] ? profiles[key][currentCurrency.toLowerCase()] : profiles['scalable'][currentCurrency.toLowerCase()];
        
        // Laptop
        document.getElementById('l_hw').value = p.l.hw;
        document.getElementById('l_warranty').value = p.l.war;
        document.getElementById('l_logistics').value = p.l.log;
        document.getElementById('l_support').value = p.l.supp;
        // Security removed
        document.getElementById('l_proc').value = p.l.proc;
        document.getElementById('l_waste').value = p.l.waste;
        document.getElementById('l_prod').value = p.l.prod;

        // Cloud
        document.getElementById('c_hw').value = p.c.hw;
        document.getElementById('c_mgmt').value = p.c.mgmt;
        document.getElementById('c_life_save_rate').value = Math.abs(p.c.save_rate); // Ensure positive input for rate
        document.getElementById('c_sec_val').value = p.c.sec;
        document.getElementById('c_bcp_val').value = p.c.bcp;
        document.getElementById('c_prod').value = p.c.prod;
        document.getElementById('w365_config').value = p.c.sku;
        
        updateW365Price();
    }

    function calc() {
        const total_months = parseInt(document.getElementById('duration').value);
        const total_years = total_months / 12;
        const symbol = currentCurrency === 'USD' ? '$' : '‚Çπ';
        const inflation_rate = 0.10;

        // --- LAPTOP CALC ---
        const l_hw_base = Number(document.getElementById('l_hw').value);
        const l_war_base = Number(document.getElementById('l_warranty').value);
        const l_log_base = Number(document.getElementById('l_logistics').value);
        const l_proc_base = Number(document.getElementById('l_proc').value);
        const l_waste_base = Number(document.getElementById('l_waste').value);
        const l_warranty_cycle = parseFloat(document.getElementById('l_lifespan').value); 
        
        let l_capex_acc = 0;
        let l_indirect_acc = 0;

        // 1. Initial Purchase (Year 0) + Opportunity Cost
        let initial_spend = (l_hw_base + l_war_base + l_log_base);
        let cost_of_capital_factor = Math.pow(1 + inflation_rate, total_years);
        let adjusted_initial_spend = initial_spend * cost_of_capital_factor;
        
        l_capex_acc += adjusted_initial_spend;
        l_indirect_acc += (l_proc_base + l_waste_base); 

        // 2. Refresh Cycles
        let years_since_buy = 0;
        for (let y = 1; y < total_years; y++) {
            years_since_buy++;
            if(years_since_buy >= l_warranty_cycle) {
                // Refresh Needed
                const inflation_factor = Math.pow(1 + inflation_rate, y);
                let refresh_spend = (l_hw_base + l_war_base + l_log_base) * inflation_factor;
                
                let remaining_years = total_years - y;
                let refresh_capital_factor = Math.pow(1 + inflation_rate, remaining_years);
                
                l_capex_acc += (refresh_spend * refresh_capital_factor);
                l_indirect_acc += (l_proc_base + l_waste_base) * inflation_factor;
                years_since_buy = 0;
            }
        }

        // OpEx (Security Removed)
        const l_opex_mo = Number(document.getElementById('l_support').value);
        const l_opex_total = l_opex_mo * total_months;
        const l_prod_annual = Number(document.getElementById('l_prod').value);
        const l_prod_total = l_prod_annual * total_years;
        const l_final = l_capex_acc + l_opex_total + l_indirect_acc + l_prod_total;


        // --- CLOUD CALC ---
        const c_hw = Number(document.getElementById('c_hw').value);
        const c_lic_base = Number(document.getElementById('c_lic').value);
        const c_mgmt_base = Number(document.getElementById('c_mgmt').value);
        
        let c_opex_acc = 0;
        for (let y = 0; y < total_years; y++) {
            const inflation_factor = Math.pow(1 + inflation_rate, y);
            const monthly_cost_for_year = (c_lic_base + c_mgmt_base) * inflation_factor;
            c_opex_acc += (monthly_cost_for_year * 12);
        }

        // --- NEW SAVINGS LOGIC (Lifespan - Duration) ---
        const l_max_life = parseFloat(document.getElementById('l_max_life').value);
        const savings_rate = Number(document.getElementById('c_life_save_rate').value);
        
        let extension_years = l_max_life - l_warranty_cycle;
        if(extension_years < 0) extension_years = 0;

        // Rate * Extension Years = Total Saving
        const c_life_save_total = -(savings_rate * extension_years);

        const c_sec_val = Number(document.getElementById('c_sec_val').value) * total_years; 
        const c_bcp_val = Number(document.getElementById('c_bcp_val').value) * total_years; 
        
        const c_savings_total = c_life_save_total + c_sec_val + c_bcp_val; 

        const c_prod_annual = Number(document.getElementById('c_prod').value);
        const c_prod_total = c_prod_annual * total_years;

        const c_final = c_hw + c_opex_acc + c_savings_total + c_prod_total;


        // --- RENDER ---
        document.getElementById('resultTitle').innerText = `${total_years}-Year TCO Comparison`;
        
        document.getElementById('r_l_capex').innerText = symbol + l_capex_acc.toLocaleString(undefined, {maximumFractionDigits:0});
        document.getElementById('r_l_opex').innerText = symbol + l_opex_total.toLocaleString(undefined, {maximumFractionDigits:0});
        document.getElementById('r_l_indirect').innerText = symbol + (l_indirect_acc + l_prod_total).toLocaleString(undefined, {maximumFractionDigits:0});
        document.getElementById('r_l_total').innerText = symbol + l_final.toLocaleString(undefined, {maximumFractionDigits:0});

        document.getElementById('r_c_capex').innerText = symbol + c_hw.toLocaleString(undefined, {maximumFractionDigits:0});
        document.getElementById('r_c_opex').innerText = symbol + c_opex_acc.toLocaleString(undefined, {maximumFractionDigits:0});
        document.getElementById('r_c_savings').innerText = symbol + c_savings_total.toLocaleString(undefined, {maximumFractionDigits:0});
        document.getElementById('r_c_total').innerText = symbol + c_final.toLocaleString(undefined, {maximumFractionDigits:0});

        const maxVal = Math.max(l_final, c_final) * 1.1; 
        document.getElementById('bar_laptop').style.width = Math.max(0, (l_final / maxVal * 100)) + '%';
        document.getElementById('bar_cloud').style.width = Math.max(0, (c_final / maxVal * 100)) + '%';
        document.getElementById('bar_laptop').innerText = symbol + l_final.toLocaleString(undefined, {maximumFractionDigits:0});
        document.getElementById('bar_cloud').innerText = symbol + c_final.toLocaleString(undefined, {maximumFractionDigits:0});

        const diff = l_final - c_final;
        const badge = document.getElementById('verdict_badge');

        if (diff > 0) {
            badge.innerText = `W365 saves ${symbol}${Math.abs(diff).toLocaleString(undefined, {maximumFractionDigits:0})}`;
            badge.style.color = "#107c10";
            badge.style.borderColor = "#107c10";
        } else {
            badge.innerText = `Laptop saves ${symbol}${Math.abs(diff).toLocaleString(undefined, {maximumFractionDigits:0})}`;
            badge.style.color = "#d83b01";
            badge.style.borderColor = "#d83b01";
        }
    }
    
    handleDurationChange();
    loadProfile();
</script>

</body>
</html>