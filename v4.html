<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enterprise W365 TCO Model - International Default</title>
    <style>
        :root {
            --primary: #0078d4;
            --bg: #f3f2f1;
            --card-bg: #ffffff;
            --text-main: #323130;
            --header-capex: #d13438;
            --header-opex: #0078d4;
            --header-indirect: #ff8c00;
            --bar-laptop: #d83b01;
            --bar-cloud: #0078d4;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            padding: 20px;
            margin: 0;
        }

        .container { max-width: 1400px; margin: 0 auto; }

        /* HEADER */
        header { 
            background: #fff; padding: 25px; border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); margin-bottom: 20px;
        }
        h1 { margin: 0 0 5px 0; color: var(--primary); font-size: 1.8em; }

        /* CONTROLS BAR */
        .controls-grid {
            display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 20px;
            align-items: end; margin-top: 15px;
        }
        @media (max-width: 768px) { .controls-grid { grid-template-columns: 1fr; } }

        .control-item label { display: block; font-weight: bold; font-size: 0.85em; color: #555; margin-bottom: 5px; }
        select { 
            width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 4px; 
            font-size: 1em; background: #faf9f8; cursor: pointer;
        }

        /* MAIN CALC GRID */
        .calc-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;
        }
        @media (max-width: 900px) { .calc-grid { grid-template-columns: 1fr; } }

        .column {
            background: var(--card-bg); border-radius: 8px; overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex; flex-direction: column;
        }
        .col-title { padding: 12px; background: #333; color: white; text-align: center; font-weight: bold; font-size: 1.1em; }

        .section-header {
            padding: 8px 20px; font-size: 0.75em; font-weight: 800; text-transform: uppercase;
            border-top: 1px solid #eee; border-bottom: 1px solid #eee; background: #faf9f8; letter-spacing: 0.5px;
        }
        .text-capex { color: var(--header-capex); }
        .text-opex { color: var(--header-opex); }
        .text-indirect { color: var(--header-indirect); }

        .inputs-wrapper { padding: 15px 20px; }
        .form-group { margin-bottom: 12px; position: relative; }
        
        .label-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px; }
        .label-text { font-size: 0.85em; font-weight: 600; display: flex; align-items: center; gap: 6px; }
        
        /* TOOLTIP */
        .info-icon {
            cursor: help; color: #0078d4; font-size: 1.1em; position: relative; display: inline-block;
        }
        .info-icon::after {
            content: attr(data-tooltip);
            position: absolute; left: 50%; bottom: 120%; transform: translateX(-50%);
            width: 240px; background: #333; color: #fff; padding: 10px; border-radius: 6px;
            font-size: 0.8em; font-weight: normal; line-height: 1.4;
            visibility: hidden; opacity: 0; transition: opacity 0.2s; z-index: 100;
            pointer-events: none; text-align: left; box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .info-icon:hover::after { visibility: visible; opacity: 1; }

        /* INPUTS */
        .input-group { position: relative; }
        .currency-symbol {
            position: absolute; left: 10px; top: 50%; transform: translateY(-50%);
            color: #666; font-weight: bold; font-size: 0.9em; pointer-events: none;
        }
        input { 
            width: 100%; padding: 8px 10px 8px 25px;
            border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; 
            font-size: 0.95em; transition: 0.2s; 
        }
        input:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 2px rgba(0,120,212,0.1); }

        /* RESULTS CARD */
        .tco-card {
            background: #252423; color: white; border-radius: 12px; padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        .tco-header { display: flex; justify-content: space-between; align-items: end; border-bottom: 1px solid #555; padding-bottom: 20px; margin-bottom: 30px; }
        .savings-badge { font-size: 1.2em; font-weight: bold; padding: 8px 20px; border-radius: 6px; border: 1px solid #555; background: rgba(255,255,255,0.05); }

        /* CHARTS */
        .chart-row { display: flex; align-items: center; margin-bottom: 15px; }
        .chart-label { width: 100px; font-weight: bold; font-size: 1em; }
        .chart-track { flex-grow: 1; background: #3b3a39; height: 35px; border-radius: 6px; overflow: hidden; }
        .chart-bar { height: 100%; display: flex; align-items: center; justify-content: flex-end; padding-right: 15px; font-weight: bold; font-size: 0.9em; white-space: nowrap; transition: width 0.6s cubic-bezier(0.2, 0.8, 0.2, 1); }
        .bar-laptop { background: var(--bar-laptop); }
        .bar-cloud { background: var(--bar-cloud); }

        /* BREAKDOWN */
        .breakdown-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin-top: 20px; }
        .bd-col { padding: 0 10px; border-radius: 8px; }
        .bd-row { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 0.9em; opacity: 0.9; border-bottom: 1px solid #444; padding-bottom: 4px;}
        .bd-total { display: flex; justify-content: space-between; font-weight: bold; font-size: 1.2em; margin-top: 15px; padding-top: 10px; border-top: 2px solid #666; opacity: 1; }

    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Enterprise TCO Model</h1>
        <p style="margin:0; color:#666; font-size: 0.9em;">Comparison of Physical Endpoints vs. Windows 365 Cloud PCs</p>
        
        <div class="controls-grid">
            <div class="control-item">
                <label>Select Use Case Profile</label>
                <select id="profileSelect" onchange="loadProfile()">
                    <optgroup label="Workforce Types">
                        <option value="intl" selected>International Users (Default)</option>
                        <option value="scalable">Scalable Computing</option>
                        <option value="byod">BYOD (Bring Your Own Device)</option>
                        <option value="temp">Temp / Contractual / Consultants</option>
                        <option value="remote">Remote Workforce</option>
                        <option value="shift">Shift Workers / BPO</option>
                    </optgroup>
                    <optgroup label="Specialized Roles">
                        <option value="dev">Developers</option>
                        <option value="gpu">GPU / HPC & Design</option>
                        <option value="exec">Executive (Non-Windows Devices)</option>
                        <option value="security">Data Security (High Compliance)</option>
                    </optgroup>
                    <optgroup label="Business Events">
                        <option value="merger">Merger & Acquisition (M&A)</option>
                        <option value="onboarding">Quick Onboarding / Employee Experience</option>
                        <option value="project">Project Based Requirements</option>
                        <option value="continuity">Business Continuity</option>
                    </optgroup>
                    <optgroup label="Operational & Legacy">
                        <option value="legacy">Legacy Application Support</option>
                        <option value="patch">Patch Management</option>
                        <option value="esu">ESU (Extended Security Updates)</option>
                        <option value="custom">Custom Images / Role Based Access</option>
                        <option value="ease">Ease of Management & Operations</option>
                        <option value="predictable">Predictable Pricing for IT/Finance</option>
                        <option value="reserve">Reserve Capacity</option>
                    </optgroup>
                    <optgroup label="External & Automated">
                        <option value="partners">Partners</option>
                        <option value="suppliers">Suppliers & Distributors</option>
                        <option value="kiosk">Billing / Kiosk / Material Inward</option>
                        <option value="bots">AI BOTs / RPA</option>
                        <option value="training">Training & Inductions</option>
                    </optgroup>
                </select>
            </div>
            <div class="control-item">
                <label>Currency</label>
                <select id="currency" onchange="changeCurrency()">
                    <option value="USD" selected>üá∫üá∏ USD ($)</option>
                    <option value="INR">üáÆüá≥ INR (‚Çπ)</option>
                </select>
            </div>
            <div class="control-item">
                <label>Duration</label>
                <select id="duration" onchange="handleDurationChange()">
                    <option value="12">1 Year</option>
                    <option value="24">2 Years</option>
                    <option value="36" selected>3 Years</option>
                    <option value="48">4 Years</option>
                    <option value="60">5 Years</option>
                </select>
            </div>
        </div>
    </header>

    <div class="calc-grid">
        
        <div class="column">
            <div class="col-title">üíª Physical Laptop / Desktop</div>
            
            <div class="section-header text-capex">Hardware & Lifecycle (CapEx)</div>
            <div class="inputs-wrapper">
                <div class="form-group">
                    <div class="label-row">
                        <span class="label-text">Hardware Cost <span class="info-icon" data-tooltip="Base price of the device.">‚ìò</span></span>
                    </div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="l_hw" oninput="calc()"></div>
                </div>
                <div class="form-group">
                    <div class="label-row">
                        <span class="label-text">Device Lifespan (Years) <span class="info-icon" data-tooltip="Years before replacement. If Duration > Lifespan, a refresh cost is added.">‚ìò</span></span>
                    </div>
                    <div class="input-group"><span class="currency-symbol" style="font-size:0.8em">Y</span><input type="number" id="l_lifespan" value="3" oninput="calc()"></div>
                </div>
                <div class="form-group">
                    <div class="label-row">
                        <span class="label-text">Peripherals & Logistics <span class="info-icon" data-tooltip="Shipping, monitors, docks, and return logistics.">‚ìò</span></span>
                    </div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="l_logistics" oninput="calc()"></div>
                </div>
            </div>

            <div class="section-header text-opex">IT Ops & Support (OpEx)</div>
            <div class="inputs-wrapper">
                <div class="form-group">
                    <div class="label-row">
                        <span class="label-text">Monthly Support <span class="info-icon" data-tooltip="Helpdesk, break/fix, and ticketing costs per month.">‚ìò</span></span>
                    </div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="l_support" oninput="calc()"></div>
                </div>
                <div class="form-group">
                    <div class="label-row">
                        <span class="label-text">Security & Mgmt Stack <span class="info-icon" data-tooltip="VPN, Antivirus, DLP, ESU, and Mgmt licenses per month.">‚ìò</span></span>
                    </div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="l_sec" oninput="calc()"></div>
                </div>
            </div>

            <div class="section-header text-indirect">Indirect / Soft Costs</div>
            <div class="inputs-wrapper">
                <div class="form-group">
                    <div class="label-row">
                        <span class="label-text">Procurement Overhead <span class="info-icon" data-tooltip="Internal cost to gather requirements and process orders.">‚ìò</span></span>
                    </div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="l_procure_overhead" oninput="calc()"></div>
                </div>
                <div class="form-group">
                    <div class="label-row">
                        <span class="label-text">Over-Provisioning Waste <span class="info-icon" data-tooltip="Cost of buying specs you don't use (cannot downsize physical).">‚ìò</span></span>
                    </div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="l_waste" oninput="calc()"></div>
                </div>
                <div class="form-group">
                    <div class="label-row">
                        <span class="label-text">Productivity Loss <span class="info-icon" data-tooltip="Wait times for shipping, provisioning, and repairs (Total $).">‚ìò</span></span>
                    </div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="l_productivity" oninput="calc()"></div>
                </div>
            </div>
        </div>

        <div class="column">
            <div class="col-title">‚òÅÔ∏è Windows 365</div>
            
            <div class="section-header text-capex">Setup & Access (CapEx)</div>
            <div class="inputs-wrapper">
                <div class="form-group">
                    <div class="label-row">
                        <span class="label-text">Thin Client / BYOD <span class="info-icon" data-tooltip="Reimbursement or cheap endpoint cost.">‚ìò</span></span>
                    </div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="c_hw" oninput="calc()"></div>
                </div>
            </div>

            <div class="section-header text-opex">Cloud Subscription (OpEx)</div>
            <div class="inputs-wrapper">
                <div class="form-group">
                    <div class="label-row">
                        <span class="label-text">Configuration SKU</span>
                    </div>
                    <select id="w365_config" onchange="updateW365Price()">
                        <option value="basic">Basic: 2vCPU / 4GB</option>
                        <option value="standard">Standard: 2vCPU / 8GB</option>
                        <option value="premium">Premium: 4vCPU / 16GB</option>
                        <option value="power">Power: 8vCPU / 32GB</option>
                        <option value="gpu">Workstation: GPU</option>
                    </select>
                </div>
                <div class="form-group">
                    <div class="label-row">
                        <span class="label-text">Monthly License Fee</span>
                    </div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="c_lic" oninput="calc()"></div>
                </div>
                <div class="form-group">
                    <div class="label-row">
                        <span class="label-text">Mgmt Overhead <span class="info-icon" data-tooltip="Intune management cost (lower than physical).">‚ìò</span></span>
                    </div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="c_mgmt" oninput="calc()"></div>
                </div>
            </div>

            <div class="section-header text-indirect">Indirect / Soft Costs</div>
            <div class="inputs-wrapper">
                <div class="form-group">
                    <div class="label-row">
                        <span class="label-text">Procurement Overhead <span class="info-icon" data-tooltip="Minimal: Adding a license in M365 Admin center.">‚ìò</span></span>
                    </div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="c_procure_overhead" oninput="calc()"></div>
                </div>
                <div class="form-group">
                    <div class="label-row">
                        <span class="label-text">Productivity Loss <span class="info-icon" data-tooltip="Wait time to spin up Cloud PC (approx 1 hr).">‚ìò</span></span>
                    </div>
                    <div class="input-group"><span class="currency-symbol">$</span><input type="number" id="c_productivity" oninput="calc()"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="tco-card">
        <div class="tco-header">
            <div>
                <h2 id="resultTitle">3-Year TCO Comparison</h2>
            </div>
            <div class="savings-badge" id="verdict_badge">Calculating...</div>
        </div>

        <div style="margin-bottom:30px;">
            <div class="chart-row">
                <div class="chart-label">üíª Laptop</div>
                <div class="chart-track">
                    <div class="chart-bar bar-laptop" id="bar_laptop" style="width: 50%;">$0</div>
                </div>
            </div>
            <div class="chart-row">
                <div class="chart-label">‚òÅÔ∏è W365</div>
                <div class="chart-track">
                    <div class="chart-bar bar-cloud" id="bar_cloud" style="width: 50%;">$0</div>
                </div>
            </div>
        </div>

        <div class="breakdown-grid">
            <div class="bd-col">
                <div class="bd-row" style="color:var(--header-capex)"><span>CapEx (One-Time)</span> <span id="r_l_capex">$0</span></div>
                <div class="bd-row" style="color:var(--header-opex)"><span>OpEx (Recurring)</span> <span id="r_l_opex">$0</span></div>
                <div class="bd-row" style="color:var(--header-indirect)"><span>Indirect Costs</span> <span id="r_l_indirect">$0</span></div>
                <div class="bd-total"><span>Laptop Total</span> <span id="r_l_total">$0</span></div>
            </div>
            <div class="bd-col">
                <div class="bd-row" style="color:var(--header-capex)"><span>CapEx (One-Time)</span> <span id="r_c_capex">$0</span></div>
                <div class="bd-row" style="color:var(--header-opex)"><span>OpEx (Recurring)</span> <span id="r_c_opex">$0</span></div>
                <div class="bd-row" style="color:var(--header-indirect)"><span>Indirect Costs</span> <span id="r_c_indirect">$0</span></div>
                <div class="bd-total"><span>W365 Total</span> <span id="r_c_total">$0</span></div>
            </div>
        </div>
    </div>
</div>

<script>
    // --- 1. CONFIG DATA ---
    const w365_skus = {
        basic: { usd: 31, inr: 2785 },
        standard: { usd: 41, inr: 3685 },
        premium: { usd: 66, inr: 5930 },
        power: { usd: 158, inr: 11050 },
        gpu: { usd: 350, inr: 25000 }
    };

    function p(l_arr, c_arr, l_inr_arr, c_inr_arr) {
        return {
            usd: { 
                l: { hw: l_arr[0], log: l_arr[1], supp: l_arr[2], sec: l_arr[3], proc: l_arr[4], waste: l_arr[5], prod: l_arr[6] }, 
                c: { hw: c_arr[0], mgmt: c_arr[1], proc: c_arr[2], prod: c_arr[3], sku: c_arr[4] } 
            },
            inr: {
                l: { hw: l_inr_arr[0], log: l_inr_arr[1], supp: l_inr_arr[2], sec: l_inr_arr[3], proc: l_inr_arr[4], waste: l_inr_arr[5], prod: l_inr_arr[6] },
                c: { hw: c_inr_arr[0], mgmt: c_inr_arr[1], proc: c_inr_arr[2], prod: c_inr_arr[3], sku: c_arr[4] } 
            }
        };
    }

    // --- 2. PROFILE DEFINITIONS ---
    const profiles = {
        // 1. Scalable Computing
        scalable: p([1200, 150, 30, 15, 50, 100, 200], [0, 5, 5, 20, 'standard'], 
                    [85000, 5000, 1500, 1000, 3000, 5000, 8000], [0, 400, 200, 500]),
        byod: p([1200, 150, 30, 15, 50, 100, 200], [0, 5, 5, 20, 'standard'], 
                [85000, 5000, 1500, 1000, 3000, 5000, 8000], [0, 400, 200, 500]),
        temp: p([800, 200, 40, 15, 100, 50, 300], [0, 5, 5, 20, 'basic'], 
                [60000, 8000, 2000, 1000, 5000, 2000, 10000], [0, 400, 200, 500]),
        merger: p([1200, 300, 50, 25, 400, 200, 800], [0, 5, 10, 50, 'standard'], 
                  [85000, 12000, 3000, 1500, 20000, 10000, 30000], [0, 400, 500, 1500]),
        gpu: p([4000, 200, 60, 20, 200, 800, 500], [0, 5, 10, 50, 'gpu'], 
               [350000, 10000, 4000, 1500, 10000, 50000, 20000], [0, 400, 500, 1500]),
        security: p([1500, 150, 40, 60, 100, 200, 300], [0, 5, 5, 20, 'standard'], 
                    [110000, 5000, 2500, 4500, 5000, 10000, 12000], [0, 400, 200, 500]),
        continuity: p([1000, 50, 10, 10, 50, 1000, 0], [0, 1, 1, 0, 'standard'], 
                      [75000, 2000, 500, 500, 2000, 75000, 0], [0, 100, 100, 0]),
        partners: p([1000, 400, 50, 30, 200, 100, 500], [0, 5, 5, 20, 'basic'], 
                    [75000, 15000, 3000, 2000, 10000, 5000, 15000], [0, 400, 200, 500]),
        suppliers: p([1000, 400, 50, 30, 200, 100, 500], [0, 5, 5, 20, 'basic'], 
                     [75000, 15000, 3000, 2000, 10000, 5000, 15000], [0, 400, 200, 500]),
        onboarding: p([1300, 200, 30, 15, 100, 150, 600], [0, 5, 5, 20, 'standard'], 
                      [90000, 8000, 1500, 1000, 5000, 6000, 25000], [0, 400, 200, 500]),
        ease: p([1200, 150, 60, 15, 50, 100, 200], [0, 2, 2, 20, 'standard'], 
                [85000, 5000, 3500, 1000, 3000, 5000, 8000], [0, 200, 100, 500]),
        legacy: p([1200, 150, 50, 15, 50, 100, 300], [0, 10, 10, 50, 'standard'], 
                  [85000, 5000, 3000, 1000, 3000, 5000, 12000], [0, 800, 500, 1500]),
        exec: p([2500, 100, 50, 20, 100, 0, 200], [0, 5, 5, 20, 'premium'], 
                [200000, 4000, 3000, 1500, 5000, 0, 8000], [0, 400, 200, 500]),
        patch: p([1100, 150, 70, 20, 50, 100, 200], [0, 5, 5, 20, 'standard'], 
                 [80000, 5000, 4000, 1200, 3000, 5000, 8000], [0, 400, 200, 500]),
        dev: p([2200, 150, 40, 15, 100, 300, 400], [0, 5, 5, 20, 'power'], 
               [180000, 5000, 2500, 1000, 5000, 15000, 15000], [0, 400, 200, 500]),
        project: p([1500, 200, 40, 15, 150, 200, 300], [0, 5, 5, 20, 'premium'], 
                   [110000, 8000, 2500, 1000, 8000, 10000, 12000], [0, 400, 200, 500]),
        remote: p([1200, 500, 60, 25, 100, 150, 600], [0, 5, 5, 20, 'standard'], 
                  [85000, 15000, 3500, 1500, 5000, 8000, 20000], [0, 400, 200, 500]),
        bots: p([800, 50, 20, 10, 50, 0, 100], [0, 2, 2, 0, 'basic'], 
                [60000, 2000, 1000, 800, 3000, 0, 4000], [0, 200, 100, 0]),
        training: p([1000, 100, 20, 10, 50, 500, 100], [0, 2, 5, 10, 'basic'], 
                    [70000, 4000, 1000, 800, 3000, 20000, 4000], [0, 200, 200, 300]),
        shift: p([1000, 100, 40, 15, 50, 50, 300], [0, 5, 5, 20, 'basic'], 
                 [75000, 4000, 2500, 1000, 3000, 3000, 10000], [0, 400, 200, 500]),
        custom: p([1400, 150, 50, 15, 100, 150, 300], [0, 10, 10, 20, 'premium'], 
                  [100000, 5000, 3000, 1000, 5000, 8000, 12000], [0, 800, 500, 500]),
        predictable: p([1200, 150, 40, 15, 100, 200, 200], [0, 5, 5, 20, 'standard'], 
                       [85000, 5000, 2500, 1000, 5000, 10000, 8000], [0, 400, 200, 500]),
        esu: p([800, 100, 40, 60, 50, 0, 300], [0, 5, 5, 20, 'standard'], 
               [60000, 4000, 2500, 4000, 3000, 0, 10000], [0, 400, 200, 500]),
        reserve: p([1000, 50, 10, 10, 50, 1000, 0], [0, 1, 1, 0, 'standard'], 
                   [75000, 2000, 500, 500, 2000, 75000, 0], [0, 100, 100, 0]),
        kiosk: p([700, 100, 20, 10, 50, 0, 200], [0, 2, 2, 10, 'basic'], 
                 [50000, 4000, 1000, 800, 3000, 0, 5000], [0, 200, 100, 300]),
        intl: p([1400, 800, 60, 25, 300, 200, 800], [0, 5, 5, 20, 'standard'], 
                [100000, 30000, 3500, 1500, 15000, 10000, 25000], [0, 400, 200, 500])
    };

    let currentCurrency = 'USD';

    function changeCurrency() {
        currentCurrency = document.getElementById('currency').value;
        const symbol = currentCurrency === 'USD' ? '$' : '‚Çπ';
        document.querySelectorAll('.currency-symbol').forEach(span => {
            if(span.innerText !== 'Y') span.innerText = symbol;
        });
        loadProfile();
    }

    function handleDurationChange() {
        const dur = document.getElementById('duration').value;
        const years = parseInt(dur) / 12;
        document.getElementById('l_lifespan').value = years;
        calc();
    }

    function updateW365Price() {
        const sku = document.getElementById('w365_config').value;
        const price = w365_skus[sku][currentCurrency.toLowerCase()];
        document.getElementById('c_lic').value = price;
        calc();
    }

    function loadProfile() {
        const key = document.getElementById('profileSelect').value;
        const p = profiles[key][currentCurrency.toLowerCase()];
        
        // Laptop Inputs
        document.getElementById('l_hw').value = p.l.hw;
        document.getElementById('l_logistics').value = p.l.log;
        document.getElementById('l_support').value = p.l.supp;
        document.getElementById('l_sec').value = p.l.sec;
        document.getElementById('l_procure_overhead').value = p.l.proc;
        document.getElementById('l_waste').value = p.l.waste;
        document.getElementById('l_productivity').value = p.l.prod; 

        // Cloud Inputs
        document.getElementById('c_hw').value = p.c.hw;
        document.getElementById('c_mgmt').value = p.c.mgmt;
        document.getElementById('c_procure_overhead').value = p.c.proc;
        document.getElementById('c_productivity').value = p.c.prod;
        document.getElementById('w365_config').value = p.c.sku;
        
        updateW365Price();
    }

    function calc() {
        const months = parseInt(document.getElementById('duration').value);
        const years = months / 12;
        const symbol = currentCurrency === 'USD' ? '$' : '‚Çπ';

        // === LAPTOP CALC ===
        const l_lifespan = parseFloat(document.getElementById('l_lifespan').value);
        let refreshes = 0;
        if(l_lifespan < years) {
             refreshes = Math.ceil(years / l_lifespan) - 1;
        }

        const l_hw_cost = Number(document.getElementById('l_hw').value);
        const l_log = Number(document.getElementById('l_logistics').value);
        const l_proc = Number(document.getElementById('l_procure_overhead').value);
        const l_prod = Number(document.getElementById('l_productivity').value);
        const l_waste = Number(document.getElementById('l_waste').value);
        const l_opex_mo = Number(document.getElementById('l_support').value) + Number(document.getElementById('l_sec').value);

        // -- BUCKETS --
        // CapEx = HW + Logistics (Refreshable)
        const l_capex_display = (l_hw_cost + l_log) * (1 + refreshes);
        
        // OpEx = Monthly fees * Months
        const l_opex_display = l_opex_mo * months;

        // Indirects = Proc + Prod + Waste (Refreshable or One-time)
        // Assumption: Waste, Proc, and Prod happen every refresh cycle as well
        const l_indirect_display = (l_proc + l_prod + l_waste) * (1 + refreshes);

        const l_final = l_capex_display + l_opex_display + l_indirect_display;

        // === CLOUD CALC ===
        const c_hw = Number(document.getElementById('c_hw').value);
        const c_opex_mo = Number(document.getElementById('c_lic').value) + Number(document.getElementById('c_mgmt').value);
        const c_proc = Number(document.getElementById('c_procure_overhead').value);
        const c_prod = Number(document.getElementById('c_productivity').value);

        const c_capex_display = c_hw; // Thin client or BYOD
        const c_opex_display = c_opex_mo * months;
        const c_indirect_display = c_proc + c_prod; // Usually one-time setup
        
        const c_final = c_capex_display + c_opex_display + c_indirect_display;

        // === RENDER ===
        document.getElementById('resultTitle').innerText = `${years}-Year TCO Comparison`;
        
        // Laptop Breakdown
        document.getElementById('r_l_capex').innerText = symbol + l_capex_display.toLocaleString(undefined, {maximumFractionDigits:0});
        document.getElementById('r_l_opex').innerText = symbol + l_opex_display.toLocaleString(undefined, {maximumFractionDigits:0});
        document.getElementById('r_l_indirect').innerText = symbol + l_indirect_display.toLocaleString(undefined, {maximumFractionDigits:0});
        document.getElementById('r_l_total').innerText = symbol + l_final.toLocaleString(undefined, {maximumFractionDigits:0});

        // Cloud Breakdown
        document.getElementById('r_c_capex').innerText = symbol + c_capex_display.toLocaleString(undefined, {maximumFractionDigits:0});
        document.getElementById('r_c_opex').innerText = symbol + c_opex_display.toLocaleString(undefined, {maximumFractionDigits:0});
        document.getElementById('r_c_indirect').innerText = symbol + c_indirect_display.toLocaleString(undefined, {maximumFractionDigits:0});
        document.getElementById('r_c_total').innerText = symbol + c_final.toLocaleString(undefined, {maximumFractionDigits:0});

        const maxVal = Math.max(l_final, c_final) * 1.1; 
        document.getElementById('bar_laptop').style.width = (l_final / maxVal * 100) + '%';
        document.getElementById('bar_cloud').style.width = (c_final / maxVal * 100) + '%';
        document.getElementById('bar_laptop').innerText = symbol + l_final.toLocaleString(undefined, {maximumFractionDigits:0});
        document.getElementById('bar_cloud').innerText = symbol + c_final.toLocaleString(undefined, {maximumFractionDigits:0});

        const diff = Math.abs(l_final - c_final);
        const badge = document.getElementById('verdict_badge');

        if (l_final < c_final) {
            badge.innerText = `Physical saves ${symbol}${diff.toLocaleString(undefined, {maximumFractionDigits:0})}`;
            badge.style.color = "#ffb900";
            badge.style.borderColor = "#ffb900";
        } else {
            badge.innerText = `W365 saves ${symbol}${diff.toLocaleString(undefined, {maximumFractionDigits:0})}`;
            badge.style.color = "#4caf50";
            badge.style.borderColor = "#4caf50";
        }
    }
    
    // Init
    handleDurationChange();
    loadProfile();
</script>

</body>
</html>